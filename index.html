<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼‚åœ°åŒ»ä¿ä¸é—¨ç‰¹åŠç†æ”»ç•¥ - ä¸Šæµ·é™ªè¯Šå°æ²³</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- QRCode.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <style>
        /* éšè—æ»šåŠ¨æ¡ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        body { 
            background-color: #F8FAFC; /* Slate-50 */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* å¼¹çª—åŠ¨ç”» */
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .modal-animate { animation: fadeIn 0.2s ease-out forwards; }

        /* äºŒç»´ç ä¿®æ­£æ ·å¼ */
        #qrcode canvas { display: none !important; }
        #qrcode img { display: block !important; margin: 0 auto; max-width: 100%; height: auto; }
        
        /* å¹³æ»‘æ»šåŠ¨ */
        html { scroll-behavior: smooth; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // --- å›¾æ ‡ç»„ä»¶ ---
        const Icon = ({ name, className }) => {
            const icons = {
                Shield: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
                MapPin: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
                FileText: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></svg>,
                Smartphone: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>,
                Info: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>,
                ArrowUp: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m5 12 7-7 7 7"/><path d="M12 19V5"/></svg>,
                Phone: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
                MessageCircleDots: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/><path d="M8 12h.01"/><path d="M12 12h.01"/><path d="M16 12h.01"/></svg>,
                Link: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
                CreditCard: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>,
                AlertTriangle: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
            };
            return icons[name] || null;
        };

        // --- è¾…åŠ©ç»„ä»¶ ---
        function Card({ children, className = "" }) {
            return (
                <div className={`bg-white p-6 rounded-2xl shadow-sm border border-slate-100 transition-shadow duration-300 ${className}`}>
                    {children}
                </div>
            );
        }

        function Step({ id, number, title, desc, note, badge, badgeColor = "blue", isActive, onSelect }) {
            // é¢œè‰²é…ç½®æ˜ å°„
            const colors = {
                blue: {
                    line: "bg-blue-100",
                    circleActive: "bg-blue-600 text-white ring-blue-100", // è¿™è¡Œå…¶å®ä¸ä¼šç”¨åˆ°ï¼Œå› ä¸ºactiveæ—¶ä¼šåˆ‡åˆ°orange
                    circleInactive: "bg-blue-500 ring-blue-100 group-hover:bg-blue-400",
                    contentActive: "bg-blue-50/50", // åŒæ ·ä¸ä¼šç”¨åˆ°
                    titleActive: "text-blue-700",
                    badge: "bg-blue-50 text-blue-600 border-blue-100",
                    note: "text-blue-600 bg-blue-50 border-blue-100"
                },
                orange: {
                    line: "bg-orange-100",
                    circleActive: "bg-orange-600 text-white ring-orange-100",
                    circleInactive: "bg-orange-500 ring-orange-100 group-hover:bg-orange-400",
                    contentActive: "bg-orange-50/50",
                    titleActive: "text-orange-700",
                    badge: "bg-orange-50 text-orange-600 border-orange-100",
                    note: "text-orange-600 bg-orange-50 border-orange-100"
                }
            };
            
            // æ ¸å¿ƒé€»è¾‘ä¿®æ”¹ï¼š
            // å¦‚æœ isActive ä¸º trueï¼Œå¼ºåˆ¶ä½¿ç”¨ "orange" é…è‰²æ–¹æ¡ˆ
            // å¦‚æœ isActive ä¸º falseï¼Œä½¿ç”¨ä¼ å…¥çš„ badgeColor (é»˜è®¤ä¸º "blue")
            const theme = isActive ? "orange" : badgeColor;
            const c = colors[theme] || colors.blue;

            return (
                <div 
                    onClick={() => onSelect(id)}
                    className={`relative pl-8 pb-8 last:pb-0 group cursor-pointer transition-all duration-200`}
                >
                    {/* ç«–çº¿ */}
                    <div className={`absolute left-[11px] top-6 bottom-0 w-0.5 ${c.line} last:hidden transition-colors duration-300`}></div>
                    
                    {/* åœ†åœˆæ•°å­— */}
                    <div className={`absolute left-0 top-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white shadow-sm z-10 transition-all duration-300 
                        ${isActive 
                            ? `${c.circleActive} ring-4 scale-110` 
                            : `${c.circleInactive} text-white ring-1 group-hover:scale-110`
                        }`}
                    >
                        {number}
                    </div>
                    
                    {/* å†…å®¹ */}
                    <div className={`transition-all duration-300 p-2 -my-2 -mr-2 rounded-lg ${isActive ? c.contentActive : 'hover:bg-slate-50'}`}>
                        <div className="flex items-center gap-2">
                            <h3 className={`font-bold text-sm transition-colors ${isActive ? c.titleActive : 'text-slate-700'}`}>
                                {title}
                            </h3>
                            {badge && <span className={`${c.badge} text-[10px] px-1.5 py-0.5 rounded border font-medium transition-colors duration-300`}>{badge}</span>}
                        </div>
                        <p className="text-sm text-slate-600 mt-1 leading-relaxed select-none">{desc}</p>
                        {note && (
                            <p className={`text-xs mt-2 font-medium ${c.note} inline-block px-2 py-1 rounded-lg transition-colors duration-300`}>
                                ğŸ’¡ {note}
                            </p>
                        )}
                    </div>
                </div>
            );
        }

        function SectionHeader({ title, iconName, color = "blue" }) {
            const bgClass = color === "orange" ? "bg-orange-100 text-orange-700" : "bg-blue-100 text-blue-700";
            return (
                <div className="flex items-center gap-2 mb-4 pb-2 border-b border-slate-200">
                    <div className={`p-2 rounded-lg ${bgClass}`}>
                        <Icon name={iconName} className="w-5 h-5" />
                    </div>
                    <h2 className="text-xl font-bold text-slate-800">{title}</h2>
                </div>
            );
        }

        // --- å†…å®¹åŒºå— ---

        function Phase1({ activeStep, onStepSelect }) {
            return (
                <Card>
                    <div className="space-y-2">
                        <Step id="p1-1" isActive={activeStep === 'p1-1'} onSelect={onStepSelect}
                            number="1" title="æ‰“å¼€æ”¯ä»˜å®æœç´¢" desc="ç›´æ¥åœ¨æ”¯ä»˜å®ä¸Šæ–¹æœç´¢æ è¾“å…¥â€œå¼‚åœ°å°±åŒ»å¤‡æ¡ˆâ€ã€‚" badge="å…¥å£" />
                        
                        <Step id="p1-2" isActive={activeStep === 'p1-2'} onSelect={onStepSelect}
                            number="2" title="é€‰æ‹©å¤‡æ¡ˆç±»å‹" desc="ä¸€èˆ¬é€‰æ‹©â€œå¼‚åœ°é•¿æœŸå±…ä½â€å’Œâ€œå¼‚åœ°ä¸´æ—¶å¤–å‡ºâ€ä¸¤ç§é€‰é¡¹ã€‚" 
                            note="é•¿æœŸå±…ä½æŠ¥é”€æ¯”ä¾‹é€šå¸¸æ›´é«˜ï¼Œä½†éœ€è¦æä¾›å±…ä½è¯æ˜æˆ–ç­¾ç½²æ‰¿è¯ºä¹¦ã€‚" badge="å…³é”®" />
                        
                        {/* è¿™é‡Œä¸å†éœ€è¦æ‰‹åŠ¨ä¼ é€’ badgeColor æ¡ä»¶ï¼ŒStep ç»„ä»¶å·²ç»Ÿä¸€å¤„ç† */}
                        <Step id="p1-3" isActive={activeStep === 'p1-3'} onSelect={onStepSelect}
                            number="3" title="æ¸©é¦¨æç¤º" desc="ä¸€èˆ¬é€‰æ‹©â€œä¸´æ—¶å¤–å‡ºâ€æˆ–â€œé•¿æœŸå±…ä½â€ã€‚å°½é‡ä¸è¦é€‰â€œè½¬è¯Šâ€å¤‡æ¡ˆã€‚" 
                            note="è½¬è¯Šé€šå¸¸éœ€è¦å½“åœ°åŒ»é™¢å¼€å…·ä¸¥æ ¼çš„è½¬è¯Šè¯æ˜ï¼Œå¦åˆ™æ— æ³•å®¡æ ¸é€šè¿‡ã€‚" badge="æç¤º" />
                        
                        <div className="bg-slate-50 p-3 rounded-lg border border-slate-100 text-xs text-slate-500 mt-2">
                            <span className="font-bold text-slate-700">ğŸ“ ä¸¾ä¾‹ï¼š</span> è‹å·åŒ»ä¿ä¸´æ—¶å¤–å‡ºå°±åŒ»ï¼Œä¸€èˆ¬æŒ‰åŸè§„å®šç»“ä»˜æ¯”ä¾‹çš„ 80% ç»“ç®—ã€‚
                        </div>
                    </div>
                </Card>
            );
        }

        function Phase2({ activeStep, onStepSelect }) {
            return (
                <div className="space-y-4">
                    {/* çŸ¥è¯†ç‚¹å¡ç‰‡ */}
                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-100 flex items-start gap-3">
                        <div className="bg-blue-100 p-2 rounded-full text-blue-600 shrink-0">
                            <Icon name="Shield" className="w-5 h-5" />
                        </div>
                        <div>
                            <h4 className="font-bold text-blue-800 text-sm">ä»€ä¹ˆæ˜¯â€œé—¨ç‰¹â€ï¼Ÿ</h4>
                            <p className="text-xs text-blue-700 mt-1 leading-relaxed">
                                å…¨ç§°â€œé—¨è¯Šç‰¹æ®Šç—…ç§â€ï¼ˆéƒ¨åˆ†åœ°åŒºæœ‰æ…¢ç—…ï¼‰ï¼ŒåŒ…æ‹¬æ¶æ€§è‚¿ç˜¤æ”¾åŒ–ç–—ã€é€æç­‰ã€‚åŠç†åï¼Œåœ¨é—¨è¯Šäº§ç”Ÿçš„ç›¸å…³æ²»ç–—è´¹ç”¨å¯äº«å—ç±»ä¼¼ä½é™¢çš„æŠ¥é”€å¾…é‡ã€‚
                            </p>
                        </div>
                    </div>

                    <Card>
                        <div className="space-y-2">
                            <Step id="p2-1" isActive={activeStep === 'p2-1'} onSelect={onStepSelect}
                                number="1" title="å‡†å¤‡ç”³è¯·ææ–™" desc="æ ¸å¿ƒææ–™åŒ…æ‹¬ï¼šã€Šé—¨è¯Šæ…¢ç‰¹ç—…ç—…ç§å¾…é‡ç”³è¯·è¡¨ã€‹ã€ç–¾ç—…è¯Šæ–­ä¹¦ã€ç—…ç†æŠ¥å‘Šã€è¿‘æœŸé—¨è¯Šç—…å†åŠæ£€æŸ¥æŠ¥å‘Šã€‚" 
                                note="ç”³è¯·è¡¨éœ€ç”±å…·æœ‰èµ„è´¨åŒ»é™¢çš„ä¸“ç§‘å‰¯ä¸»ä»»åŠä»¥ä¸ŠåŒ»å¸ˆå¡«å†™ï¼Œå¹¶ç»åŒ»é™¢åŒ»ä¿ç§‘ç›–ç« ã€‚" badge="å‡†å¤‡" />
                            
                            <Step id="p2-2" isActive={activeStep === 'p2-2'} onSelect={onStepSelect}
                                number="2" title="é€‰æ‹©åŠç†æ¸ é“" desc="å„åœ°æ”¿ç­–ä¸åŒï¼Œé€šå¸¸æœ‰ä¸‰ç§æ–¹å¼ï¼šâ‘  å½“åœ°åŒ»ä¿å±€å°ç¨‹åº/APPçº¿ä¸ŠåŠç†ï¼›â‘¡ åŒ»ä¿å±€æŒ‡å®šåŒ»é™¢çš„ä¸€ç«™å¼æœåŠ¡çª—å£ï¼›â‘¢ åŒ»ä¿å±€ç»åŠå¤§å…ç°åœºåŠç†ã€‚" badge="åŠç†" />
                            
                            <Step id="p2-3" isActive={activeStep === 'p2-3'} onSelect={onStepSelect}
                                number="3" title="ç­‰å¾…å®¡æ ¸ç”Ÿæ•ˆ" desc="æäº¤åç­‰å¾…å®¡æ ¸ã€‚å®¡æ ¸é€šè¿‡åï¼Œåœ¨é—¨è¯Šè¿›è¡Œç›¸å…³æ²»ç–—ï¼ˆå¦‚æ”¾ç–—ï¼‰å³å¯äº«å—ç‰¹ç—…å¾…é‡ã€‚" />
                        </div>
                    </Card>
                </div>
            );
        }

        function Phase3({ activeStep, onStepSelect }) {
            return (
                <div className="space-y-4">
                    <Card className="bg-gradient-to-br from-white to-slate-50">
                        <h3 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                            <Icon name="Link" className="w-5 h-5 text-blue-500" />
                            åŒ»ä¿é€»è¾‘å…³ç³»å…¬å¼
                        </h3>
                        
                        <div className="space-y-3">
                            {/* å…¬å¼ 1 */}
                            <div className="bg-white p-3 rounded-lg border border-slate-200 shadow-sm">
                                <div className="text-xs text-slate-400 mb-1">åŸºç¡€èº«ä»½å·®å¼‚</div>
                                <div className="flex items-center justify-between text-sm font-bold text-slate-700">
                                    <span>èŒå·¥åŒ»ä¿</span>
                                    <span className="text-blue-500">&gt;</span>
                                    <span>å±…æ°‘åŒ»ä¿</span>
                                </div>
                                <div className="text-[10px] text-slate-500 mt-1">èŒå·¥æŠ¥é”€æ¯”ä¾‹é€šå¸¸é«˜äºå±…æ°‘åŒ»ä¿ã€‚</div>
                            </div>

                            {/* å…¬å¼ 2 */}
                            <div className="bg-white p-3 rounded-lg border border-slate-200 shadow-sm">
                                <div className="text-xs text-slate-400 mb-1">å¼‚åœ°æŠ¥é”€å·®å¼‚</div>
                                <div className="flex items-center justify-between text-sm font-bold text-slate-700">
                                    <span>å¼‚åœ°é—¨ç‰¹</span>
                                    <span className="text-blue-500">&gt;</span>
                                    <span>æ™®é€šå¼‚åœ°é—¨è¯Š</span>
                                </div>
                                <div className="text-[10px] text-slate-500 mt-1">åŠäº†é—¨ç‰¹ï¼ŒæŠ¥é”€æ¯”ä¾‹æ¯”æ™®é€šçœ‹é—¨è¯Šè¦é«˜å¾ˆå¤šã€‚</div>
                            </div>

                            {/* ç»ˆæç»„åˆ */}
                            <div className="bg-blue-600 p-4 rounded-xl text-white shadow-md mt-4">
                                <div className="text-xs text-blue-200 mb-2 font-medium">âœ¨ æœ€ä½³æŠ¥é”€ç»„åˆå…¬å¼</div>
                                <div className="flex flex-col gap-2">
                                    <div className="flex items-center gap-2">
                                        <div className="bg-white/20 px-2 py-1 rounded text-xs">èŒå·¥/å±…æ°‘åŒ»ä¿</div>
                                        <span className="text-xs opacity-70">(åŸºç¡€)</span>
                                    </div>
                                    <div className="text-center text-xs opacity-50">+</div>
                                    <div className="flex items-center gap-2">
                                        <div className="bg-white/20 px-2 py-1 rounded text-xs">å¼‚åœ°å¤‡æ¡ˆ</div>
                                        <span className="text-xs opacity-70">(å‰æ: ä¸´æ—¶/é•¿æœŸ)</span>
                                    </div>
                                    <div className="text-center text-xs opacity-50">+</div>
                                    <div className="flex items-center gap-2">
                                        <div className="bg-white text-blue-700 px-2 py-1 rounded text-xs font-bold shadow-sm">é—¨ç‰¹è®¤å®š</div>
                                        <span className="text-xs opacity-90 font-bold">(æœ€ç»ˆç›®çš„)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Card>

                    <div className="bg-orange-50 border border-orange-100 p-4 rounded-xl flex gap-3">
                        <Icon name="AlertTriangle" className="w-5 h-5 text-orange-500 shrink-0 mt-0.5" />
                        <div className="text-xs text-orange-800 leading-relaxed">
                            <span className="font-bold">æ³¨æ„ï¼š</span> 
                            å¼‚åœ°ä½¿ç”¨é—¨ç‰¹ï¼Œé€šå¸¸éœ€è¦å…ˆè¿›è¡Œå¼‚åœ°å°±åŒ»å¤‡æ¡ˆã€‚éƒ¨åˆ†åœ°åŒºè¦æ±‚å¿…é¡»æ˜¯â€œå¼‚åœ°é•¿æœŸå±…ä½â€æ‰èƒ½äº«å—é—¨ç‰¹å¾…é‡ï¼Œä¹Ÿæœ‰éƒ¨åˆ†åœ°åŒºæ”¯æŒâ€œä¸´æ—¶å¤–å‡ºâ€ä½¿ç”¨é—¨ç‰¹ã€‚è¯·åŠ¡å¿…æ‹¨æ‰“å½“åœ°åŒ»ä¿å±€ç”µè¯æ ¸å®ã€‚
                        </div>
                    </div>
                </div>
            );
        }

        // --- ä¸» App ç»„ä»¶ ---

        function App() {
            const [activeTab, setActiveTab] = useState('filing');
            const [activeStep, setActiveStep] = useState(null);
            const [showQR, setShowQR] = useState(false);
            const qrInstanceRef = useRef(null);

            const p1Ref = useRef(null);
            const p2Ref = useRef(null);
            const p3Ref = useRef(null);

            const tabs = [
                { id: 'filing', label: '1.å¼‚åœ°å¤‡æ¡ˆ', icon: 'Smartphone', ref: p1Ref },
                { id: 'mente', label: '2.é—¨ç‰¹ç”³è¯·', icon: 'FileText', ref: p2Ref },
                { id: 'relation', label: '3.æŠ¥é”€é€»è¾‘', icon: 'Link', ref: p3Ref },
            ];

            const scrollToSection = (id, ref) => {
                setActiveTab(id);
                const offset = 150; 
                const element = ref.current;
                if (element) {
                    const y = element.getBoundingClientRect().top + window.scrollY - offset;
                    window.scrollTo({ top: y, behavior: 'smooth' });
                }
            };

            const handleStepSelect = (stepId) => {
                setActiveStep(stepId === activeStep ? null : stepId); 
            };

            // ç›‘å¬æ»šåŠ¨
            useEffect(() => {
                const handleScroll = () => {
                    const scrollY = window.scrollY;
                    const offset = 200;
                    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 20) {
                        setActiveTab(tabs[tabs.length - 1].id);
                        return;
                    }
                    let currentSection = tabs[0].id;
                    for (const tab of tabs) {
                        const element = tab.ref.current;
                        if (element && element.offsetTop - offset <= scrollY) {
                            currentSection = tab.id;
                        }
                    }
                    setActiveTab(currentSection);
                };
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            // äºŒç»´ç é€»è¾‘
            useEffect(() => {
                const qrContainer = document.getElementById("qrcode");
                if (qrContainer && !qrInstanceRef.current) {
                    qrContainer.innerHTML = ""; 
                    qrInstanceRef.current = new QRCode(qrContainer, {
                        text: "https://u.wechat.com/EKcPjhL9GyGJtvlbGIc9Bbs",
                        width: 200, 
                        height: 200,
                        colorDark : "#2563eb", // blue-600
                        colorLight : "#ffffff",
                        correctLevel : QRCode.CorrectLevel.H
                    });

                    setTimeout(() => {
                        const canvas = qrContainer.querySelector('canvas');
                        const img = qrContainer.querySelector('img');
                        if (canvas && (!img || !img.src || img.style.display === 'none')) {
                            const dataUrl = canvas.toDataURL("image/png");
                            let targetImg = img;
                            if (!targetImg) {
                                targetImg = document.createElement("img");
                                qrContainer.appendChild(targetImg);
                            }
                            targetImg.src = dataUrl;
                            targetImg.style.display = "block";
                            canvas.style.display = "none";
                        }
                    }, 100); 
                }
            }, []);

            return (
                <div className="min-h-screen pb-20 selection:bg-blue-100 font-sans text-slate-800">
                    
                    {/* å¾®ä¿¡å¼¹çª— */}
                    <div 
                        id="qrModal" 
                        className={`fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900 bg-opacity-70 backdrop-blur-sm transition-all duration-300 ${showQR ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}`}
                        onClick={() => setShowQR(false)}
                    >
                        <div 
                            className={`bg-white rounded-2xl p-6 max-w-sm w-full relative shadow-2xl transform transition-all duration-300 ${showQR ? 'scale-100' : 'scale-95'}`}
                            onClick={e => e.stopPropagation()}
                        >
                            <button onClick={() => setShowQR(false)} className="absolute top-3 right-4 text-slate-400 hover:text-slate-700 text-3xl font-light focus:outline-none">&times;</button>
                            
                            <div className="text-center mt-2">
                                <h3 className="text-xl font-bold text-slate-800 mb-1">æ·»åŠ å¾®ä¿¡å’¨è¯¢</h3>
                                <p className="text-sm text-slate-500 mb-4">é•¿æŒ‰è¯†åˆ«æˆ–æ‰«ä¸€æ‰«ä¸‹æ–¹äºŒç»´ç </p>
                                
                                <div className="bg-blue-50 p-6 rounded-xl border border-blue-100 mb-4 flex justify-center items-center">
                                    <div id="qrcode"></div>
                                </div>
                                
                                <div className="font-bold text-blue-700 text-lg">ä¸Šæµ·é™ªè¯Šå°æ²³</div>
                                <div className="text-slate-500 text-sm flex items-center justify-center gap-1 mt-1">
                                    <Icon name="Phone" className="w-3 h-3" />
                                    <span>17898872018</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Header */}
                    <header className="bg-white shadow-sm sticky top-0 z-50">
                        <div className="px-5 py-4 flex justify-between items-center bg-white">
                            <div className="flex flex-col">
                                <h1 className="text-slate-800 font-bold text-base leading-none tracking-tight">ä¸Šæµ·é™ªè¯Šå°æ²³</h1>
                                <div className="flex items-center gap-1 text-slate-400 text-xs mt-1.5 font-medium tracking-wide">
                                    <Icon name="CreditCard" className="w-3 h-3" />
                                    <span>åŒ»ä¿/é—¨ç‰¹åŠç†æŒ‡å¼•</span>
                                </div>
                            </div>
                            <button 
                                onClick={() => setShowQR(true)}
                                className="flex items-center gap-1.5 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 px-3 py-1.5 rounded-full transition-all text-xs md:text-sm font-bold shrink-0 cursor-pointer shadow-sm"
                            >
                                <Icon name="MessageCircleDots" className="w-4 h-4" />
                                <span>è¯¢é—®å°æ²³æ”»ç•¥</span>
                            </button>
                        </div>
                    
                        {/* å¯¼èˆªæ  */}
                        <div className="bg-white flex overflow-x-auto border-t border-slate-100 no-scrollbar">
                            {tabs.map((tab) => (
                                <button
                                    key={tab.id}
                                    onClick={() => scrollToSection(tab.id, tab.ref)}
                                    className={`flex-1 py-3 px-2 text-sm font-medium flex flex-col items-center gap-1 min-w-[80px] transition-all whitespace-nowrap ${
                                        activeTab === tab.id 
                                            ? 'text-blue-700 border-b-2 border-blue-600 bg-blue-50/50' 
                                            : 'text-slate-400 hover:text-slate-600 hover:bg-slate-50'
                                    }`}
                                >
                                    <Icon name={tab.icon} className="w-4 h-4" />
                                    {tab.label}
                                </button>
                            ))}
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-2xl mx-auto p-4 space-y-8 mt-2">
                        <div className="px-2 pt-2 pb-0">
                            <h1 className="text-2xl font-bold text-slate-900 tracking-tight mb-2 flex items-center gap-2">
                                <Icon name="CreditCard" className="w-6 h-6 text-blue-600" />
                                å¼‚åœ°å°±åŒ»ä¸é—¨ç‰¹
                            </h1>
                            <p className="text-slate-500 text-sm ml-1 border-l-2 border-slate-200 pl-3 leading-relaxed">
                                ææ‡‚å¼‚åœ°å¤‡æ¡ˆä¸é—¨è¯Šç‰¹æ®Šç—…ç§ï¼ˆé—¨ç‰¹ï¼‰ï¼Œçœ‹ç—…æŠ¥é”€æ›´çœé’±ã€‚
                            </p>
                        </div>

                        <div className="bg-blue-50 p-4 rounded-xl border border-blue-100 flex gap-3">
                            <Icon name="Info" className="w-5 h-5 text-blue-600 shrink-0 mt-0.5" />
                            <div className="text-sm text-blue-800 leading-relaxed">
                                æœ¬æŒ‡å—æ¢³ç†äº†<strong>æ”¯ä»˜å®å¤‡æ¡ˆ</strong>ã€<strong>é—¨ç‰¹ç”³è¯·</strong>åŠä¸¤è€…ä¹‹é—´çš„<strong>æŠ¥é”€é€»è¾‘</strong>ã€‚ç‚¹å‡»æ­¥éª¤å¯æ ‡è®°è¿›åº¦ã€‚
                            </div>
                        </div>

                        {/* Phase 1 */}
                        <div ref={p1Ref} className="scroll-mt-40">
                            <SectionHeader title="ç¬¬ä¸€æ­¥ï¼šå¼‚åœ°å°±åŒ»å¤‡æ¡ˆ" iconName="Smartphone" />
                            <Phase1 activeStep={activeStep} onStepSelect={handleStepSelect} />
                        </div>

                        {/* Phase 2 */}
                        <div ref={p2Ref} className="scroll-mt-40">
                            <SectionHeader title="ç¬¬äºŒæ­¥ï¼šé—¨ç‰¹åŠç† (å…³é”®)" iconName="Shield" />
                            <Phase2 activeStep={activeStep} onStepSelect={handleStepSelect} />
                        </div>

                        {/* Phase 3 */}
                        <div ref={p3Ref} className="scroll-mt-40">
                            <SectionHeader title="ç¬¬ä¸‰æ­¥ï¼šææ‡‚æŠ¥é”€å…³ç³»" iconName="Link" />
                            <Phase3 activeStep={activeStep} onStepSelect={handleStepSelect} />
                        </div>

                    </main>
                    
                    {/* Footer */}
                    <footer className="text-center text-slate-400 text-xs py-8 max-w-2xl mx-auto border-t border-slate-200 mt-8 px-4">
                        <p>æ³¨ï¼šå†…å®¹ä»…ä¾›ç»éªŒå‚è€ƒã€‚å„åœ°åŒ»ä¿æ”¿ç­–å„ä¸ç›¸åŒï¼Œå¯ç”µè¯å½“åœ°åŒ»ä¿å±€ç¡®è®¤ </p>
                        <p className="mt-2 opacity-60">
                            ä¸çŸ¥é“å¦‚ä½•æ“ä½œ? <button onClick={() => setShowQR(true)} className="underline hover:text-slate-600">è¯¢é—®å°æ²³æ”»ç•¥</button>
                        </p>
                    </footer>
                    
                    <button onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })} className="fixed bottom-6 right-6 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors z-10 opacity-80 hover:opacity-100">
                        <Icon name="ArrowUp" className="w-5 h-5" />
                    </button>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>